<div class="board-container">
  <!-- Filters -->
  <div class="filters">
    <input
      type="text"
      class="search-box"
      placeholder="Search by Title..."
      [(ngModel)]="searchQuery"
      (input)="applyFilters()"
    />

    <select [(ngModel)]="selectedUser" (change)="applyFilters()">
      <option value="">All Users</option>
      <option *ngFor="let user of users" [value]="user.fullName">
        {{ user.fullName }}
      </option>
    </select>
  </div>

  <!-- Kanban Board -->
  <div class="board row">
    <div class="column col-3" *ngFor="let status of statuses">
      @if(hasTicketsForStatus(status)) {
      <h3>{{ status }}</h3>
      <div
        class="ticket-card"
        *ngFor="let ticket of getFilteredTickets(status)"
      >
        <div class="card card-bg">
          <div class="card-body ticket-bg border" id="3">
            <!---->
            <div class="my-1 fw-bold">{{ ticket.summary }}</div>
            <div class="row">
              <div class="col-3">
                <p class="text-muted space-font m-0 pointer"></p>
              </div>
              <div class="col-9 text-end">
                <p class="text-muted space-font m-0">
                  {{ ticket.assignedTo }}
                </p>
              </div>
            </div>
          </div>
          <div class="card-footer ticket-bg border justify-content-between">
            <button
              (click)="editTicket(ticket)"
              data-bs-toggle="modal"
              data-bs-target="#myModal"
              class="edit-btn"
            >
              Edit
            </button>
            <button class="delete-btn" (click)="deleteTicket(ticket.ticketId)">
              delete
            </button>
          </div>
        </div>
      </div>

      }
    </div>
  </div>
</div>

<!-- Edit Modal -->
<div class="modal fade" id="myModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Edit Ticket</h4>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
        ></button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-12">
            <label>Summary:</label>
            <input
              type="text"
              name="summary"
              class="form-control"
              [(ngModel)]="selectedTicket.summary"
            />
          </div>
          <div class="col-12">
            <label>Description:</label>
            <textarea
              class="form-control"
              [(ngModel)]="selectedTicket.description"
            ></textarea>
          </div>
          <div class="col-6">
            <label>Story Points:</label>
            <input
              type="number"
              class="form-control"
              [(ngModel)]="selectedTicket.storyPoint"
            />
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" (click)="saveChanges()">Save</button>
        <button
          class="btn btn-secondary"
          id="cancelModalbtn"
          data-bs-dismiss="modal"
        >
          Cancel
        </button>
      </div>
    </div>
  </div>
</div>
